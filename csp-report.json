{
    "_comment": "CSP Violation Report Template - Configure endpoint to receive reports",
    "_version": "1.0.0",
    "_documentation": "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
    "configuration": {
        "report_uri": "https://andalusiancastle.com/api/csp-report",
        "report_to_header": {
            "group": "csp-endpoint",
            "max_age": 10886400,
            "endpoints": [
                {
                    "url": "https://andalusiancastle.com/api/csp-report"
                }
            ]
        }
    },
    "sample_violation_report": {
        "csp-report": {
            "document-uri": "https://andalusiancastle.com/",
            "referrer": "",
            "violated-directive": "script-src",
            "effective-directive": "script-src",
            "original-policy": "default-src 'self'; script-src 'self' https://www.googletagmanager.com",
            "disposition": "enforce",
            "blocked-uri": "https://malicious-script.example.com/bad.js",
            "line-number": 1,
            "column-number": 1,
            "source-file": "https://andalusiancastle.com/",
            "status-code": 200
        }
    },
    "csp_policy": {
        "default-src": [
            "'self'"
        ],
        "script-src": [
            "'self'",
            "'unsafe-inline'",
            "https://www.googletagmanager.com",
            "https://www.google-analytics.com",
            "https://maps.googleapis.com"
        ],
        "style-src": [
            "'self'",
            "'unsafe-inline'",
            "https://fonts.googleapis.com"
        ],
        "font-src": [
            "'self'",
            "https://fonts.gstatic.com"
        ],
        "img-src": [
            "'self'",
            "data:",
            "https:",
            "blob:"
        ],
        "connect-src": [
            "'self'",
            "https://www.google-analytics.com",
            "https://api.emailjs.com",
            "https://formspree.io"
        ],
        "frame-src": [
            "'self'",
            "https://www.google.com",
            "https://maps.google.com"
        ],
        "object-src": [
            "'none'"
        ],
        "base-uri": [
            "'self'"
        ],
        "form-action": [
            "'self'",
            "https://formspree.io"
        ],
        "frame-ancestors": [
            "'none'"
        ],
        "upgrade-insecure-requests": true
    },
    "monitoring_recommendations": {
        "tools": [
            "Report URI (https://report-uri.com)",
            "Sentry CSP Reporting",
            "Custom endpoint with logging"
        ],
        "alerts": {
            "threshold": 10,
            "period": "1 hour",
            "notification_channels": [
                "email",
                "slack"
            ]
        }
    },
    "testing_checklist": [
        "Test all inline scripts are allowed",
        "Test Google Maps embed works",
        "Test Google Analytics loads",
        "Test form submissions work",
        "Test fonts load correctly",
        "Test images load from all sources",
        "Monitor for any blocked resources in production"
    ]
}